---
title: OpenFOAM Tutorial - Lid Driven Cavity
tags:
  - My OpenFOAM Note
  - OpenFOAM
  - OpenFOAM
id: '1326'
date: 2018-07-10 01:26:47
---

Lid-driven cavity flow
----------------------

The lid-driven cavity flow tutorial is the easiest and most well documented tutorial on OpenFOAM. A incompressible flow in a two-dimensional square domain is shown in figure below. The top wall moves in the \[latex\]x\[/latex\]-direction at a speed of 1 m/s while the other 3 are stationary. Initially, the flow will be assumed laminar and will be solved on a uniform and non mesh using the **icoFoam** solver for laminar, isothermal, incompressible flow. Then, the effect of increased mesh resolution and mesh grading towards the walls will be investigated.

![](https://bhlin.co.network/wp/wp-content/uploads/2018/07/note_cavity.jpg) Geometry of the lid driven cavity.

* * *

Setting up the case
-------------------

### Running directory

As a first step, we copy the cavity case directory to the running directory. `cp -r $FOAM_TUTORIALS/incompressible/icoFoam/cavity/cavity <your running directory>`

### Mesh generation

OpenFOAM solves the case in **3 dimensions by default** but can be instructed to solve in **2 dimensions by specifying a ‘special’ empty boundary condition** on boundaries normal to the (3rd) dimension for which no solution is required. The mesh generator, **_blockMesh_**, generates meshes from a description specified in an input dictionary, **_blockMeshDict_** located in the **_system_** (or constant/polyMesh) directory for a given case. The **_blockMeshDict_** entries for this case are as follows:

\[cpp\]
/\*--------------------------------\*- C++ -\*----------------------------------\*\\
| =========                 |                                                 |
| \\\\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\\\    /   O peration     | Version:  5                                     |
|   \\\\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\\\/     M anipulation  |                                                 |
\\\*---------------------------------------------------------------------------\*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    object      blockMeshDict;
}
// \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* //

convertToMeters 0.1;	// scaled to the real problem dimensions（deafault is meter）

vertices
(
    (0 0 0) 	// vertices 0
    (1 0 0) 	// vertices 1
    (1 1 0) 	// vertices 2
    (0 1 0) 	// vertices 3
    (0 0 0.1)	// vertices 4
    (1 0 0.1)	// vertices 5
    (1 1 0.1)	// vertices 6
    (0 1 0.1)	// vertices 7
);

// defines the blocks using the vertex indices and the cell spacing in 3 directions
blocks
(

    hex (0 1 2 3 4 5 6 7) (20 20 1) simpleGrading (1 1 1)
);

edges
(
);

// defines the boundary patches
boundary
(
    movingWall		// patch name
    {
        type wall;	// patch type
        faces
        (
            (3 7 6 2)   // define patch surface by vertex indices
        );
    }
    fixedWalls
    {
        type wall;
        faces
        (
            (0 4 7 3)
            (2 6 5 1)
            (1 5 4 0)
        );
    }
    frontAndBack
    {
        type empty;
        faces
        (
            (0 3 2 1)
            (4 5 6 7)
        );
    }
);

mergePatchPairs
(
);

// \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* //
\[/cpp\]

The mesh is generated by running blockMesh on this blockMeshDict file. From within the case directory, this is done, simply by typing in the terminal: `blockMesh`

### Boundary and initial conditions

The initial fields set up for this case is set up to start at time t = 0 s, so the initial field data is stored in a **_0_** sub-directory of the cavity directory. The **_0_** sub-directory contains 2 files, **_p_** and **_U_**, one for each of the pressure (**_p_**) and velocity (**_U_**) fields whose initial values and boundary conditions must be set. Let us look into the file **_p_**:

\[cpp\]
/\*--------------------------------\*- C++ -\*----------------------------------\*\\
| =========                 |                                                 |
| \\\\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\\\    /   O peration     | Version:  5                                     |
|   \\\\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\\\/     M anipulation  |                                                 |
\\\*---------------------------------------------------------------------------\*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       volScalarField;
    object      p;
}
// \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* //

dimensions      \[0 2 -2 0 0 0 0\];

internalField   uniform 0;

boundaryField
{
    movingWall
    {
        type            zeroGradient;
    }

    fixedWalls
    {
        type            zeroGradient;
    }

    frontAndBack
    {
        type            empty;
    }
}

// \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* //
\[/cpp\]

* * *

*   **dimensions** specifies the dimensions of the field, here kinematic pressure, i.e. \[latex\] m^2s^{-2}\[/latex\] (see [here](https://cfd.direct/openfoam/user-guide/basic-file-format/#x17-1290004.2.6) for more information);
*   **internalField** the internal field data which can be uniform, described by a single value; or nonuniform, where all the values of the field must be specified (see [here](https://cfd.direct/openfoam/user-guide/basic-file-format/#x17-1310004.2.8) for more information);
*   **boundaryField** the boundary field data that includes boundary conditions and data for all the boundary patches.

The similar configurations can be found in the velocity field in the **_0/U_** file.

### Physical properties

For an **_icoFoam_** case, the only property that must be specified is the **kinematic viscosity**(\[latex\]\\nu \[/latex\]) which is stored from the transportProperties dictionary. We can check that the kinematic viscosity is set correctly by opening the transportProperties dictionary to view/edit its entries. This case will be run with a **Reynolds number** of 10, where the **Reynolds number** is defined as:

\[latex\]\\eqalign{ \\mathbf{Re} = \\frac{d \\vert U \\vert}{\\nu} }\[/latex\]

where \[latex\] d \[/latex\] and \[latex\] U \[/latex\] are the characteristic length and velocity respectively, and and \[latex\]\\nu \[/latex\] is the kinematic viscosity we are going to define. Here in our case \[latex\] d \[/latex\] = 0.1 m, \[latex\] U \[/latex\] = 1 m/s, so that for \[latex\] \\mathbf{Re} \[/latex\] = 10, \[latex\]\\nu \[/latex\] = 0.01 \[latex\] m^2s^{-1}\[/latex\]. Hence, the correct file entry for kinematic viscosity should be specified below:

\[cpp\]
/\*--------------------------------\*- C++ -\*----------------------------------\*\\
| =========                 |                                                 |
| \\\\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\\\    /   O peration     | Version:  5                                     |
|   \\\\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\\\/     M anipulation  |                                                 |
\\\*---------------------------------------------------------------------------\*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    "constant";
    object      transportProperties;
}
// \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* //

nu              \[0 2 -1 0 0 0 0\] 0.01;

// \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* //
\[/cpp\]

### Control of the simulation

Setting data relating to the control of time and reading and writing of the solution data are read in from the **_controlDict_** dictionary.

\[cpp\]
/\*--------------------------------\*- C++ -\*----------------------------------\*\\
| =========                 |                                                 |
| \\\\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox           |
|  \\\\    /   O peration     | Version:  5                                     |
|   \\\\  /    A nd           | Web:      www.OpenFOAM.org                      |
|    \\\\/     M anipulation  |                                                 |
\\\*---------------------------------------------------------------------------\*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    "system";
    object      controlDict;
}
// \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* \* //

application     icoFoam;

startFrom       startTime;

startTime       0;

stopAt          endTime;

endTime         0.5;

deltaT          0.005;

writeControl    timeStep;

writeInterval   20;

purgeWrite      0;

writeFormat     ascii;

writePrecision  6;

writeCompression off;

timeFormat      general;

timePrecision   6;

runTimeModifiable true;

// \*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\*\* //
\[/cpp\]

* * *

Running an application
----------------------

### Viewing the mesh

It is convenient to keep **_ParaView_** open while running other commands from the terminal, we will launch it in the background using the **&** operator by typing `paraFoam &` to run **_paraView_** at current directory. Alternatively, it can be launched from another directory location with an optional -case argument giving the case directory. `paraFoam -case <your directory (relative path)> &` The geometry and the wireframe can be obtained in **_ParaView_** . The figure below shows the configuration of **uniform mesh** distribution.

![](https://bhlin.co.network/wp/wp-content/uploads/2018/07/note_cavity-1.jpg) uniform mesh

Some modifications can be done in the **_blockMeshDict_**, if the non uniform mesh distribution is desired. We list some examples as follow:

*   **simpleGrading** The simple description specifies uniform expansions in the local \[latex\]x\_1\[/latex\], \[latex\]x\_2\[/latex\] and \[latex\]x\_3\[/latex\] directions respectively with only 3 expansion ratios. The ratio is that of the width of the end cell \[latex\]\\delta\_e\[/latex\] along one edge of a block to the width of the start cell \[latex\]\\delta\_s\[/latex\] along that edge.
    
         simpleGrading (1 2 3)    // cell expansion ratios in 3 directions
        
    
    ![](https://bhlin.co.network/wp/wp-content/uploads/2018/07/note_cavity-2.jpg) non uniform mesh - simpleGrading
    
*   **edgeGrading** This gives us the way to specified the expension ratio of the mesh on each edge directly.
    
        edgeGrading (1 1 1 1 2 2 2 2 3 3 3 3)
        
    
    This means the ratio of cell widths along edges 0-3 is 1, along edges 4-7 is 2 and along 8-11 is 3 ( the number and direction of the edge in a block can be seen [here](https://cfd.direct/openfoam/user-guide/blockMesh/#x25-1790005.3)).
    
    ![](https://bhlin.co.network/wp/wp-content/uploads/2018/07/note_cavity-3.jpg) non uniform mesh - edgeGrading
    
*   **Multi-grading of a block** In our case, we might require finer cell for the mesh near the walls. **_OpenFOAM v2.4+_** includes **multi-grading functionality** that can divide a block in an given direction and apply different grading within each division. It is specified by replacing any single value expansion ratio in the grading specification of the block. A example configuration for our cavity case is shown as follow.
    
            simpleGrading (     
                // x1-direction expansion ratio
                (
                    (0.2 0.3 4)    // 20% y-dir, 30% cells, expansion = 4
                    (0.6 0.4 1)    // 60% y-dir, 40% cells, expansion = 1
                    (0.2 0.3 0.25) // 20% y-dir, 30% cells, expansion = 0.25 (1/4)
                )
        
                // x2-direction expansion ratio
                (
                    (0.2 0.3 4)    // 20% y-dir, 30% cells, expansion = 4
                    (0.6 0.4 1)    // 60% y-dir, 40% cells, expansion = 1
                    (0.2 0.3 0.25) // 20% y-dir, 30% cells, expansion = 0.25 (1/4)
                )
        
                // x3-direction expansion ratio
                    1                  
            )
        
    
    ![](https://bhlin.co.network/wp/wp-content/uploads/2018/07/note_cavity-4.jpg) non uniform mesh - multi-grading
    

* * *

### Running

The **_icoFoam_** solver is executed either by entering the case directory and typing `icoFoam` at the command prompt, or with the optional -case argument giving the case directory. `icoFoam -case <your running directory>` ![](https://bhlin.co.network/wp/wp-content/uploads/2019/01/3v4MKgWjQYs-300x224.png)

_pressure contour and the velocity vector_

* * *

*   Reference:

1.  [CFD Direct](https://cfd.direct/openfoam/user-guide/cavity/)
2.  [OpenFOAM for beginners: Hands-on training](https://www.slideshare.net/JibranHaider/openfoam-for-beginners?)
3.  [OpenFOAM tutorial](http://www.optimulation.com/2011/11/07/openfoam-tutorial-1-lid-driven-cavity-flow/)
4.  [OpenFOAM step by step tutorial](file:///home/binghan/%E4%B8%8B%E8%BC%89/OpenFOAM_Formation_103.pdf)