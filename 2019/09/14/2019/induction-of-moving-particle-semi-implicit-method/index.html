<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Introduction of Moving Particle Semi-Implicit Method | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Governing EquationsGoverning equations are expressed by conservation of mass and momentum. The equations are: $$\eqalign{ \frac{D\rho}{Dt}+\rho \nabla \cdot \mathbf{u} &#x3D;0 }$$ and $$\eqalign{ \fra">
<meta property="og:type" content="article">
<meta property="og:title" content="Introduction of Moving Particle Semi-Implicit Method">
<meta property="og:url" content="http://example.com/2019/09/14/2019/induction-of-moving-particle-semi-implicit-method/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Governing EquationsGoverning equations are expressed by conservation of mass and momentum. The equations are: $$\eqalign{ \frac{D\rho}{Dt}+\rho \nabla \cdot \mathbf{u} &#x3D;0 }$$ and $$\eqalign{ \fra">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-09-14T15:29:31.000Z">
<meta property="article:modified_time" content="2022-12-11T08:33:56.229Z">
<meta property="article:author" content="John Doe">
<meta property="article:tag" content="Computational Fluid Dynamics (CFD)">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2019/induction-of-moving-particle-semi-implicit-method" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/09/14/2019/induction-of-moving-particle-semi-implicit-method/" class="article-date">
  <time datetime="2019-09-14T15:29:31.000Z" itemprop="datePublished">2019-09-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Introduction of Moving Particle Semi-Implicit Method
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Governing-Equations"><a href="#Governing-Equations" class="headerlink" title="Governing Equations"></a>Governing Equations</h2><p>Governing equations are expressed by conservation of mass and momentum. The equations are:</p>
<p>$$<br>\eqalign{ \frac{D\rho}{Dt}+\rho \nabla \cdot \mathbf{u} &#x3D;0 }<br>$$</p>
<p>and</p>
<p>$$<br>\eqalign{ \frac{D \mathbf{u} }{Dt}&#x3D;-\frac{1}{\rho}\nabla P +\nu \nabla^2 \mathbf{u} +\mathbf{f} }<br>$$</p>
<p>where $\rho$ indicates density, $P$ is the pressure, $\mathbf{u}$ the velocity and $\mathbf{f}$ the external force. It should be noted that the first equation is written in the form of compressible flow. In the MPS method, <strong>incompressibility is enforced by way of setting $\frac{ D \rho}{D t}&#x3D;0$ at each particle at each calculation time step</strong>.</p>
<span id="more"></span>


<hr>
<h2 id="Particle-Interaction-Models"><a href="#Particle-Interaction-Models" class="headerlink" title="Particle Interaction Models"></a>Particle Interaction Models</h2><h3 id="Weighting-functions"><a href="#Weighting-functions" class="headerlink" title="Weighting functions"></a>Weighting functions</h3><p>The particle interacts with its neighboring particles which are covered with a weight function $w(\mathbf{r})$, where $\mathbf{r}$ is the distance between two particles. There are many kinds of form for this weight function, we employed the following one:</p>
<p>$$<br>\eqalign{<br>  w(\mathbf{r}) &#x3D; \begin{cases}<br>  \frac{r_e}{r}-1 &amp; ,0 \leq r &lt;r_e \<br>  0 &amp; ,r&gt;r_e \end{cases}<br>}<br>$$</p>
<p>For each particle, only a finite number of neighboring particles are related to the interactions.</p>
<h3 id="Particle-number-density-langle-n-rangle-i"><a href="#Particle-number-density-langle-n-rangle-i" class="headerlink" title="Particle number density $\langle n \rangle_i$"></a>Particle number density $\langle n \rangle_i$</h3><p>When a particle $i$ and its neighbors $j$ are located at $\mathbf{r_i}$ and $\mathbf{r_j}$, <strong>particle number density</strong> $\langle n \rangle_i$ is defined as,</p>
<p>$$<br>\eqalign{<br>  \langle n \rangle_i &#x3D; \sum_{i \neq j} w\left( | \mathbf{r} _j - \mathbf{r}_i | \right )<br>}<br>$$</p>
<p>The constant value of the particle number density is denoted by $n^0$.</p>
<h3 id="The-number-of-particles-in-a-unit-volume-langle-N-rangle-i"><a href="#The-number-of-particles-in-a-unit-volume-langle-N-rangle-i" class="headerlink" title="The number of particles in a unit volume $\langle N \rangle_i$"></a>The number of particles in a unit volume $\langle N \rangle_i$</h3><p>The number of particles in a unit volume, $\langle N \rangle_i$, can be approximated by the particle number density:</p>
<p>$$<br>\eqalign{<br>\langle N \rangle_i &#x3D; \frac{\langle n \rangle_i}{\int w( \mathbf{r} )dv}<br>}<br>$$</p>
<p>The denominator of this equation is the integral of the kernel in the whole region, excluding a central part occupied by particle $i$.</p>
<h3 id="Fluid-density-langle-rho-rangle-i"><a href="#Fluid-density-langle-rho-rangle-i" class="headerlink" title="Fluid density $\langle \rho \rangle_i$"></a>Fluid density $\langle \rho \rangle_i$</h3><p>Assuming that the particles <strong>have the same mass</strong> $m$ , the fluid density, $\langle \rho \rangle_i$ is expressed as,</p>
<p>$$<br>\eqalign{<br>\langle \rho \rangle_i &#x3D; m\langle N \rangle_i &#x3D; \frac{m\langle n \rangle_i}{\int w( \mathbf{r} )dv}<br>}<br>$$</p>
<p>In the MPS method a fluid is represented by moving particles with constant mass. Thus, <strong>the incompressibily of the fluid is guaranteed by keeping the particle number density $\langle n \rangle_i$ of the fluid constant.</strong> The continuity equation is also satisfied automatically by keeping the total number of particles and the mass of individual particles constant.</p>
<hr>
<h2 id="Model-of-Mathematical-Operator"><a href="#Model-of-Mathematical-Operator" class="headerlink" title="Model of Mathematical Operator"></a>Model of Mathematical Operator</h2><p>Each mathematical operator acting on the arbitrary scalar $\phi$ and vector $\mathbf{u}$ at particle $i$ are defined as the particle interaction approximation as follows:</p>
<h3 id="Gradient-operator"><a href="#Gradient-operator" class="headerlink" title="Gradient operator"></a>Gradient operator</h3><p>Represent by the weighted average of gradient vectors.</p>
<p>$$<br>\eqalign{<br>\langle \nabla \phi \rangle_i &#x3D; \frac{d}{n^0}\sum_{i \neq j}<br>\frac{\phi_j-\phi_i}{| \mathbf{r} _j - \mathbf{r}_i |^2} \left(\mathbf{r} _j - \mathbf{r}_i \right)w\left( | \mathbf{r} _j - \mathbf{r}_i | \right )<br>}<br>$$</p>
<p>where $d$ is the number of space dimensions, $n^0$ is a particle number density ﬁxed for incompressibility.</p>
<h3 id="Laplacian-operator"><a href="#Laplacian-operator" class="headerlink" title="Laplacian operator"></a>Laplacian operator</h3><p>Part of a quantity contained by a particle $i$ is distributed to neighboring particles $j$ using the weight function.</p>
<p>$$<br>\eqalign{<br>\langle \nabla^2 \phi \rangle_i &#x3D; \frac{2d}{\lambda n^0}\sum_{i \neq j}<br>\left[\left(\phi_j-\phi_i\right) w\left( | \mathbf{r} _j - \mathbf{r}_i | \right)\right]<br>}<br>$$</p>
<p>where $\lambda$ is</p>
<p>$$<br>\eqalign{<br>\lambda &#x3D; \frac{\int_{V} w(r)r^2 dv}{\int_{V} w(r) dv} &#x3D; \frac{\sum_{i \neq j} w \left( | \mathbf{r}_j - \mathbf{r}<em>i | \right) | \mathbf{r}</em> j - \mathbf{r}<em>i |^2 }{ \sum</em>{i \neq j} w \left( | \mathbf{r}_j - \mathbf{r}_i | \right) }<br>}<br>$$</p>
<h3 id="Divergence-operator"><a href="#Divergence-operator" class="headerlink" title="Divergence operator"></a>Divergence operator</h3><p>$$<br>\eqalign{<br>\langle \nabla \cdot \mathbf{u} \rangle_i &#x3D; \frac{2d}{n^0}\sum_{i \neq j}<br>\frac{ \left( \mathbf{u}_j - \mathbf{u}_i \right) \cdot\left(\mathbf{r} _j - \mathbf{r}_i \right)}{| \mathbf{r} _j - \mathbf{r}_i |^2} w\left( | \mathbf{r} _j - \mathbf{r}_i | \right )<br>}<br>$$</p>
<hr>
<h2 id="Model-of-incompressibility"><a href="#Model-of-incompressibility" class="headerlink" title="Model of incompressibility"></a>Model of incompressibility</h2><p>Incompressibility is represented by keeping the particle number density  constant $n^0$. When the particle number density $n^*$ is not equal to<br>$n^0$, it is implicitly corrected to $n^0$ by</p>
<p>$$<br>\eqalign{<br>n^* +\Delta n^{‘} &#x3D; n^0 .<br>}$$</p>
<p>Thus, we have</p>
<p>$$<br>\eqalign{<br>\frac{1}{n^0} \frac{\Delta n^{‘}}{\Delta t}&#x3D; -\nabla \cdot \Delta \mathbf{u}^{‘}.<br>}$$</p>
<p>The velocity correction value $ \Delta \mathbf{u}^{‘}$, is derived from the implicit pressure gradient term as</p>
<p>$$<br>\eqalign{<br>  \Delta \mathbf{u}^{‘} &#x3D; -\frac{\Delta t}{\rho} \nabla P^{n+1}<br>}$$</p>
<p>A Poisson equation of pressure is obtained:</p>
<p>$$<br>\eqalign{<br>  \nabla^2 P_i^{n+1} &#x3D; -\frac{\rho}{\Delta t^2}\frac{n_i^*-n^0}{n^0}<br>}$$</p>
<hr>
<h2 id="Step-of-Semi-implicit-Algorithm"><a href="#Step-of-Semi-implicit-Algorithm" class="headerlink" title="Step of Semi-implicit Algorithm"></a>Step of Semi-implicit Algorithm</h2><ul>
<li><strong>Initialize configuration of particles</strong>:</li>
</ul>
<p>$$\eqalign{\mathbf{u}_i^0, \mathbf{r}_i^0, P_i^0 } $$</p>
<ul>
<li><em><em>Calculate the intermediate velocity $\mathbf{u}_i^</em>$ from part of momentum equation.</em>*</li>
</ul>
<p>$$\eqalign{ \mathbf{u}_i^* &#x3D; \mathbf{u}_i^n + \Delta t &amp; \left( \nu \nabla^2 \mathbf{u}_i^n + \mathbf{f} \right) } $$</p>
<ul>
<li><strong>Calculate the intermediate</strong> <em><em>coordinates of particles, $\mathbf{r}_i^</em>$</em>*.</li>
</ul>
<p>$$ \eqalign{ \mathbf{r}_i^* &#x3D; \mathbf{r}_i^n + \Delta t &amp; \mathbf{u}_i^* } $$</p>
<ul>
<li><p><em><em>Compute intermediate particle number density $n^</em>$ by using intermediate particle locations</em>*.</p>
</li>
<li><p><strong>Obtain pressure $P_i^{n+1}$ by solving pressure Poisson equation.</strong></p>
</li>
</ul>
<p>$$ \eqalign{ \nabla^2 P_i^{n+1} &#x3D; -\frac{\rho}{\Delta t^2}\frac{n_i^*-n^0}{n^0} } $$</p>
<ul>
<li><strong>Finally, new velocity $\mathbf{u}_i^{n+1}$ and new coordinates of particles $\mathbf{r}_i^{n+1}$ are computed.</strong></li>
</ul>
<p>$$ \eqalign{ \mathbf{u}_i^{n+1} &#x3D; \mathbf{u}_i^* - \frac{ \Delta t }{\rho}\nabla P_i^{n+1} } $$</p>
<p>$$ \eqalign{ \mathbf{r}_i^{n+1} &#x3D; \mathbf{r}_i^n + \Delta t &amp; \mathbf{u}_i^{n+1} } $$</p>
<hr>
<h2 id="Build-System-of-Linear-Equations"><a href="#Build-System-of-Linear-Equations" class="headerlink" title="Build System of Linear Equations"></a>Build System of Linear Equations</h2><ul>
<li><em><em>Linear Equations of intermediate velocity $\mathbf{u}_i^</em>$</em>*.</li>
</ul>
<p>$$\eqalign{<br>\mathbf{u}_i^* &#x3D; \mathbf{u}<em>i^n + \Delta t &amp; \left( \nu \frac{2d}{\lambda n^0}\sum</em>{i \neq j} \left[\left(\mathbf{u}^n_j-\mathbf{u}^n_i\right) w\left( | \mathbf{r} _j - \mathbf{r}_i | \right )\right] + \mathbf{f} \right)<br>}$$</p>
<ul>
<li><strong>Linear Equations of intermediate</strong> <em><em>coordinates of particles, $\mathbf{r}_i^</em>$</em>*.</li>
</ul>
<p>$$<br>\eqalign{ \mathbf{r}_i^* &#x3D; \mathbf{r}_i^n + \Delta t &amp; \mathbf{u}_i^* } $$</p>
<ul>
<li><strong>Linear Equations of pressure $P_i^{n+1}$ from pressure Poisson equation.</strong></li>
</ul>
<p>$$<br>\eqalign{<br>\frac{2d}{\lambda n^0}\sum_{i \neq j}<br>\left[\left(P_j-P_i\right) w\left( | \mathbf{r} _j - \mathbf{r}_i | \right )\right]<br>&#x3D; -\frac{\rho}{\Delta t^2}\frac{n_i^*-n^0}{n^0}<br>} $$</p>
<ul>
<li><strong>Linear Equations of new velocity $\mathbf{u}_i^{n+1}$ and new coordinates of particles $\mathbf{r}_i^{n+1}$.</strong></li>
</ul>
<p>$$<br>\eqalign{<br>\mathbf{u}_i^{n+1} &#x3D; \mathbf{u}<em>i^* - \frac{ \Delta t }{\rho}\frac{d}{n^0}\sum</em>{i \neq j}<br>\frac{(P_i-P_j)\cdot\left(\mathbf{r} _j - \mathbf{r}_i \right)}{| \mathbf{r} _j - \mathbf{r}_i |^2} w\left( | \mathbf{r} _j - \mathbf{r}_i | \right )<br>}$$</p>
<p>$$<br>\eqalign{ \mathbf{r}_i^{n+1} &#x3D; \mathbf{r}_i^n + \Delta t &amp; \mathbf{u}_i^{n+1} }<br>$$</p>
<hr>
<ul>
<li>Reference:</li>
</ul>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.sciencedirect.com/science/article/pii/S0169598305001322">A stable moving-particle semi-implicit method for free surface flows</a></li>
<li><a target="_blank" rel="noopener" href="https://www.wire.tu-bs.de/OLDWEB/akeese/seminarWS01/talks/mps_paper.pdf">Moving Particle Semi-Implicit Method</a></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/09/14/2019/induction-of-moving-particle-semi-implicit-method/" data-id="clbj57j7w000aw4uf9zcth4hu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Computational-Fluid-Dynamics-CFD/" rel="tag">Computational Fluid Dynamics (CFD)</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/10/04/2020/Iterative-Methods-Based-On-Splitting-Matrix/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Iterative Methods Based On Splitting Matrix
        
      </div>
    </a>
  
  
    <a href="/2019/05/18/2019/solving-differential-equations-by-neural-networks/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Solving Differential Equations by Neural Networks</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning-Note/">Machine Learning Note</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/OpenFOAM-Note/">OpenFOAM Note</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Uncategorized/">Uncategorized</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Computational-Fluid-Dynamics-CFD/" rel="tag">Computational Fluid Dynamics (CFD)</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Machine-Learning/" rel="tag">Machine Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Numerical-Method/" rel="tag">Numerical Method</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/OpenFOAM/" rel="tag">OpenFOAM</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/" rel="tag">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Uncategorized/" rel="tag">Uncategorized</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Computational-Fluid-Dynamics-CFD/" style="font-size: 10px;">Computational Fluid Dynamics (CFD)</a> <a href="/tags/Machine-Learning/" style="font-size: 10px;">Machine Learning</a> <a href="/tags/Numerical-Method/" style="font-size: 15px;">Numerical Method</a> <a href="/tags/OpenFOAM/" style="font-size: 20px;">OpenFOAM</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/Uncategorized/" style="font-size: 10px;">Uncategorized</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">December 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/12/22/2022/CMakePresets-And-VSCode/">Configure and build with CMake Presets in Visual Studio Code</a>
          </li>
        
          <li>
            <a href="/2020/10/04/2020/Iterative-Methods-Based-On-Splitting-Matrix/">Iterative Methods Based On Splitting Matrix</a>
          </li>
        
          <li>
            <a href="/2019/09/14/2019/induction-of-moving-particle-semi-implicit-method/">Introduction of Moving Particle Semi-Implicit Method</a>
          </li>
        
          <li>
            <a href="/2019/05/18/2019/solving-differential-equations-by-neural-networks/">Solving Differential Equations by Neural Networks</a>
          </li>
        
          <li>
            <a href="/2019/04/23/2019/openfoam-tutorial-extracting-numerical-data-from-case/">OpenFOAM: Extracting Numerical Data From  Case</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>